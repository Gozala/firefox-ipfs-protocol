"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.main = exports.Factory = exports.IP$$ProtocolHandler = exports.IP$$URL = exports.FSProtocolHandler = exports.FSURL = undefined;

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _gecko = require("./gecko");

var _cids = require("cids");

var _cids2 = _interopRequireDefault(_cids);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _toArray(arr) { return Array.isArray(arr) ? arr : Array.from(arr); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var ioService = _gecko.Cc['@mozilla.org/network/io-service;1'].getService(_gecko.Ci.nsIIOService);

var standardURL = _gecko.Cc["@mozilla.org/network/standard-url;1"].createInstance(_gecko.Ci.nsIStandardURL);

standardURL.QueryInterface(_gecko.Ci.nsIURL);

var runtime = _gecko.Cc["@mozilla.org/xre/app-info;1"].getService(_gecko.Ci.nsIXULRuntime);

var childProcessMessageManager = _gecko.Cc["@mozilla.org/childprocessmessagemanager;1"].getService(_gecko.Ci.nsISyncMessageSender);

var parentProcessMessageManager = _gecko.Cc["@mozilla.org/parentprocessmessagemanager;1"].getService(_gecko.Ci.nsIMessageBroadcaster);

var securityManager = _gecko.Cc["@mozilla.org/scriptsecuritymanager;1"].getService(_gecko.Ci.nsIScriptSecurityManager);

var componentRegistrar = _gecko.Cm.QueryInterface(_gecko.Ci.nsIComponentRegistrar);

var FSURL = exports.FSURL = function () {
  _createClass(FSURL, null, [{
    key: "parse",
    value: function parse(spec) {
      var _spec$split = spec.split(':'),
          _spec$split2 = _toArray(_spec$split),
          scheme = _spec$split2[0],
          _ = _spec$split2.slice(1);

      var _spec$substr$split$1$ = spec.substr(scheme.length).split(/:\/*/)[1].split('/'),
          _spec$substr$split$1$2 = _toArray(_spec$substr$split$1$),
          protocol = _spec$substr$split$1$2[0],
          id = _spec$substr$split$1$2[1],
          pathEntries = _spec$substr$split$1$2.slice(2);

      var path = pathEntries.length === 0 ? '' : "/" + pathEntries.join('/');

      return new FSURL(scheme, protocol, id, path);
    }
  }]);

  function FSURL(scheme, protocol, id, path) {
    _classCallCheck(this, FSURL);

    this.scheme = scheme;
    this.protocol = protocol;
    this.id = id;
    this.path = path;
  }

  return FSURL;
}();

var FSProtocolHandler = exports.FSProtocolHandler = function () {
  function FSProtocolHandler() {
    _classCallCheck(this, FSProtocolHandler);

    this.defaultPort = -1;
    this.protocolFlags = _gecko.Ci.nsIProtocolHandler.URI_LOADABLE_BY_SUBSUMERS | _gecko.Ci.nsIProtocolHandler.ORIGIN_IS_FULL_SPEC;
    this.scheme = 'fs';
  }

  _createClass(FSProtocolHandler, [{
    key: "allowPort",
    value: function allowPort(port, scheme) {
      return false;
    }
  }, {
    key: "newURI",
    value: function newURI(spec, charset, baseURI) {
      dump("FSProtocolHandler.newURI(" + JSON.stringify(spec) + ", " + JSON.stringify(charset) + ", " + (baseURI == null ? 'null' : baseURI.spec) + ")\n");
      if (baseURI === null || spec.startsWith(this.scheme + ":")) {
        var _FSURL$parse = FSURL.parse(spec),
            protocol = _FSURL$parse.protocol,
            id = _FSURL$parse.id,
            path = _FSURL$parse.path;

        var url = new IP$$URL(protocol, id, path);
        return ioService.newURI(IP$$URL.toBase16Encoded(url).toString(), charset, baseURI);
      } else {
        throw Error("FS Protocol handler did not expected to resolve " + spec + " relative to " + baseURI.spec);
      }
    }
  }, {
    key: "newChannel",
    value: function newChannel(uri) {
      return this.newChannel2(uri, null);
    }
  }, {
    key: "newChannel2",
    value: function newChannel2(uri, loadInfo) {
      dump("FSProtocolHandler.newChannel2(" + JSON.stringify(uri.spec) + ", " + String(loadInfo) + ")\n");
      throw new Error("Did not expect to create channel for " + uri.spec);
    }
  }, {
    key: "QueryInterface",
    value: function QueryInterface(iid) {
      if (iid.equals(_gecko.Ci.nsIProtocolHandler) || iid.equals(_gecko.Ci.nsISupports)) {
        return this;
      }
      dump("!!! FSProtocolHandler.QueryInterface " + iid.name + " " + iid.number + "\n");
      throw _gecko.Cr.NS_ERROR_NO_INTERFACE;
    }
  }]);

  return FSProtocolHandler;
}();

var IP$$URL = exports.IP$$URL = function () {
  _createClass(IP$$URL, null, [{
    key: "parse",
    value: function parse(spec) {
      var _spec$split3 = spec.split(':'),
          _spec$split4 = _toArray(_spec$split3),
          scheme = _spec$split4[0],
          _ = _spec$split4.slice(1);

      var _spec$substr$split$1$3 = spec.substr(scheme.length).split(/:\/*/)[1].split('/'),
          _spec$substr$split$1$4 = _toArray(_spec$substr$split$1$3),
          id = _spec$substr$split$1$4[0],
          pathEntries = _spec$substr$split$1$4.slice(1);

      var path = pathEntries.length === 0 ? '' : "/" + pathEntries.join('/');

      return new IP$$URL(scheme, id, path);
    }
  }, {
    key: "toBase16Encoded",
    value: function toBase16Encoded(uri) {
      return new IP$$URL(uri.scheme, new _cids2.default(uri.id).toV1().toBaseEncodedString('base16'), uri.path);
    }
  }, {
    key: "toBaseEncodedV0",
    value: function toBaseEncodedV0(uri) {
      return new IP$$URL(uri.scheme, new _cids2.default(uri.id).toV0().toBaseEncodedString('base58btc'), uri.path);
    }
  }]);

  function IP$$URL(scheme, id, path) {
    _classCallCheck(this, IP$$URL);

    this.scheme = scheme;
    this.id = id;
    this.path = path;
  }

  _createClass(IP$$URL, [{
    key: "toBase16Encoded",
    value: function toBase16Encoded() {
      return IP$$URL.toBase16Encoded(this);
    }
  }, {
    key: "toBaseEncodedV0",
    value: function toBaseEncodedV0() {
      return IP$$URL.toBaseEncodedV0(this);
    }
  }, {
    key: "toString",
    value: function toString() {
      return this.scheme + "://" + this.id + this.path;
    }
  }]);

  return IP$$URL;
}();

var IP$$ProtocolHandler = exports.IP$$ProtocolHandler = function () {
  function IP$$ProtocolHandler(scheme) {
    _classCallCheck(this, IP$$ProtocolHandler);

    this.defaultPort = -1;
    this.protocolFlags = _gecko.Ci.nsIProtocolHandler.URI_LOADABLE_BY_SUBSUMERS;

    this.scheme = scheme;
  }

  _createClass(IP$$ProtocolHandler, [{
    key: "allowPort",
    value: function allowPort(port, scheme) {
      return false;
    }
  }, {
    key: "newURI",
    value: function newURI(spec, charset, baseURI) {
      dump("IP$$ProtocolHandler<" + this.scheme + ">.newURI(" + JSON.stringify(spec) + ", " + JSON.stringify(charset) + ", " + (baseURI == null ? 'null' : baseURI.spec) + ")\n");

      if (baseURI === null || spec.startsWith(this.scheme + ":")) {
        var url = IP$$URL.parse(spec);
        if (url.scheme === this.scheme) {
          standardURL.init(_gecko.Ci.nsIStandardURL.URLTYPE_STANDARD, this.defaultPort, IP$$URL.toBase16Encoded(url).toString(), charset, null);
        } else {
          throw Error("Invalid spec was passed " + spec + " for " + this.scheme + " protocol handler");
        }
      } else {
        standardURL.init(_gecko.Ci.nsIStandardURL.URLTYPE_STANDARD, this.defaultPort, spec, charset, baseURI);
      }
      return standardURL.clone();
    }
  }, {
    key: "newChannel",
    value: function newChannel(uri) {
      return this.newChannel2(uri, null);
    }
  }, {
    key: "newChannel2",
    value: function newChannel2(uri, loadInfo) {
      dump("IP$$ProtocolHandler<" + this.scheme + ">.newChannel2(" + JSON.stringify(uri.spec) + ", " + String(loadInfo) + ")\n");

      var _IP$$URL$toBaseEncode = IP$$URL.toBaseEncodedV0(IP$$URL.parse(uri.spec)),
          scheme = _IP$$URL$toBaseEncode.scheme,
          id = _IP$$URL$toBaseEncode.id,
          path = _IP$$URL$toBaseEncode.path;

      var spec = "http://localhost:8080/" + scheme + "/" + id + path;
      var url = ioService.newURI(spec, uri.originCharset, null);
      var channel = ioService.newChannelFromURIWithLoadInfo(url, loadInfo);
      channel.originalURI = uri;
      return channel;
    }
  }, {
    key: "QueryInterface",
    value: function QueryInterface(iid) {
      if (iid.equals(_gecko.Ci.nsIProtocolHandler) || iid.equals(_gecko.Ci.nsISupports)) {
        return this;
      }
      dump("!!! FSProtocolHandler.QueryInterface " + iid.name + " " + iid.number + "\n");
      throw _gecko.Cr.NS_ERROR_NO_INTERFACE;
    }
  }]);

  return IP$$ProtocolHandler;
}();

var Factory = exports.Factory = function () {
  function Factory(instance) {
    _classCallCheck(this, Factory);

    this.instance = instance;
  }

  _createClass(Factory, [{
    key: "createInstance",
    value: function createInstance(outer, iid) {
      if (outer != null) {
        throw _gecko.Cr.NS_ERROR_NO_AGGREGATION;
      }

      return this.instance;
    }
  }, {
    key: "lockFactory",
    value: function lockFactory(lock) {
      throw _gecko.Cr.NS_ERROR_NOT_IMPLEMENTED;
    }
  }, {
    key: "QueryInterface",
    value: function QueryInterface(iid) {
      if (iid.equals(_gecko.Ci.nsISupports) || iid.equals(_gecko.Ci.nsIFactory)) {
        return this;
      }
      dump("!!! Factory.QueryInterface " + iid.name + " " + iid.number + "\n");
      throw _gecko.Cr.NS_ERROR_NO_INTERFACE;
    }
  }]);

  return Factory;
}();

var main = exports.main = function main() {
  componentRegistrar.registerFactory((0, _gecko.CID)('{b6c93a47-778a-f643-b0c8-79f6be685e06}'), 'FS protocol handler', '@mozilla.org/network/protocol;1?name=fs', new Factory(new FSProtocolHandler()));

  componentRegistrar.registerFactory((0, _gecko.CID)('{d0415967-75a1-4528-8030-b79d5552127d}'), 'IPFS protocol handler', '@mozilla.org/network/protocol;1?name=ipfs', new Factory(new IP$$ProtocolHandler('ipfs')));

  componentRegistrar.registerFactory((0, _gecko.CID)('{f866a46c-2e79-44e6-929d-334fdf8a7fd7}'), 'IPNS protocol handler', '@mozilla.org/network/protocol;1?name=ipns', new Factory(new IP$$ProtocolHandler('ipns')));

  componentRegistrar.registerFactory((0, _gecko.CID)('{8ef93514-306a-49a5-a9fa-f7a9c709b061}'), 'IPDL protocol handler', '@mozilla.org/network/protocol;1?name=ipdl', new Factory(new IP$$ProtocolHandler('ipdl')));

  if (runtime.processType == _gecko.Ci.nsIXULRuntime.PROCESS_TYPE_DEFAULT) {
    parentProcessMessageManager.loadProcessScript("data:,Components.utils.import(\"" + __URI__ + "\", {}).main()", true);
  }
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9pbmRleC5qcyJdLCJuYW1lcyI6WyJpb1NlcnZpY2UiLCJnZXRTZXJ2aWNlIiwibnNJSU9TZXJ2aWNlIiwic3RhbmRhcmRVUkwiLCJjcmVhdGVJbnN0YW5jZSIsIm5zSVN0YW5kYXJkVVJMIiwiUXVlcnlJbnRlcmZhY2UiLCJuc0lVUkwiLCJydW50aW1lIiwibnNJWFVMUnVudGltZSIsImNoaWxkUHJvY2Vzc01lc3NhZ2VNYW5hZ2VyIiwibnNJU3luY01lc3NhZ2VTZW5kZXIiLCJwYXJlbnRQcm9jZXNzTWVzc2FnZU1hbmFnZXIiLCJuc0lNZXNzYWdlQnJvYWRjYXN0ZXIiLCJzZWN1cml0eU1hbmFnZXIiLCJuc0lTY3JpcHRTZWN1cml0eU1hbmFnZXIiLCJjb21wb25lbnRSZWdpc3RyYXIiLCJuc0lDb21wb25lbnRSZWdpc3RyYXIiLCJGU1VSTCIsInNwZWMiLCJzcGxpdCIsInNjaGVtZSIsIl8iLCJzdWJzdHIiLCJsZW5ndGgiLCJwcm90b2NvbCIsImlkIiwicGF0aEVudHJpZXMiLCJwYXRoIiwiam9pbiIsIkZTUHJvdG9jb2xIYW5kbGVyIiwiZGVmYXVsdFBvcnQiLCJwcm90b2NvbEZsYWdzIiwibnNJUHJvdG9jb2xIYW5kbGVyIiwiVVJJX0xPQURBQkxFX0JZX1NVQlNVTUVSUyIsIk9SSUdJTl9JU19GVUxMX1NQRUMiLCJwb3J0IiwiY2hhcnNldCIsImJhc2VVUkkiLCJkdW1wIiwiSlNPTiIsInN0cmluZ2lmeSIsInN0YXJ0c1dpdGgiLCJwYXJzZSIsInVybCIsIklQJCRVUkwiLCJuZXdVUkkiLCJ0b0Jhc2UxNkVuY29kZWQiLCJ0b1N0cmluZyIsIkVycm9yIiwidXJpIiwibmV3Q2hhbm5lbDIiLCJsb2FkSW5mbyIsIlN0cmluZyIsImlpZCIsImVxdWFscyIsIm5zSVN1cHBvcnRzIiwibmFtZSIsIm51bWJlciIsIk5TX0VSUk9SX05PX0lOVEVSRkFDRSIsInRvVjEiLCJ0b0Jhc2VFbmNvZGVkU3RyaW5nIiwidG9WMCIsInRvQmFzZUVuY29kZWRWMCIsIklQJCRQcm90b2NvbEhhbmRsZXIiLCJpbml0IiwiVVJMVFlQRV9TVEFOREFSRCIsImNsb25lIiwib3JpZ2luQ2hhcnNldCIsImNoYW5uZWwiLCJuZXdDaGFubmVsRnJvbVVSSVdpdGhMb2FkSW5mbyIsIm9yaWdpbmFsVVJJIiwiRmFjdG9yeSIsImluc3RhbmNlIiwib3V0ZXIiLCJOU19FUlJPUl9OT19BR0dSRUdBVElPTiIsImxvY2siLCJOU19FUlJPUl9OT1RfSU1QTEVNRU5URUQiLCJuc0lGYWN0b3J5IiwibWFpbiIsInJlZ2lzdGVyRmFjdG9yeSIsInByb2Nlc3NUeXBlIiwiUFJPQ0VTU19UWVBFX0RFRkFVTFQiLCJsb2FkUHJvY2Vzc1NjcmlwdCIsIl9fVVJJX18iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQVdBOztBQUNBOzs7Ozs7Ozs7O0FBRUEsSUFBTUEsWUFDSixVQUFHLG1DQUFILEVBQ0FDLFVBREEsQ0FDVyxVQUFHQyxZQURkLENBREY7O0FBSUEsSUFBTUMsY0FDSixVQUFHLHFDQUFILEVBQ0FDLGNBREEsQ0FDZSxVQUFHQyxjQURsQixDQURGOztBQUlBRixZQUFZRyxjQUFaLENBQTJCLFVBQUdDLE1BQTlCOztBQUVBLElBQU1DLFVBQ0osVUFBRyw2QkFBSCxFQUNBUCxVQURBLENBQ1csVUFBR1EsYUFEZCxDQURGOztBQUlBLElBQU1DLDZCQUNKLFVBQUcsMkNBQUgsRUFDQVQsVUFEQSxDQUNXLFVBQUdVLG9CQURkLENBREY7O0FBSUEsSUFBTUMsOEJBQ0osVUFBRyw0Q0FBSCxFQUNBWCxVQURBLENBQ1csVUFBR1kscUJBRGQsQ0FERjs7QUFJQSxJQUFNQyxrQkFDSixVQUFHLHNDQUFILEVBQ0FiLFVBREEsQ0FDVyxVQUFHYyx3QkFEZCxDQURGOztBQUlBLElBQU1DLHFCQUFxQixVQUFHVixjQUFILENBQWtCLFVBQUdXLHFCQUFyQixDQUEzQjs7SUF3SWFDLEssV0FBQUEsSzs7OzBCQUNFQyxJLEVBQWE7QUFBQSx3QkFDREEsS0FBS0MsS0FBTCxDQUFXLEdBQVgsQ0FEQztBQUFBO0FBQUEsVUFDakJDLE1BRGlCO0FBQUEsVUFDTkMsQ0FETTs7QUFBQSxrQ0FHdEJILEtBQUtJLE1BQUwsQ0FBWUYsT0FBT0csTUFBbkIsRUFBMkJKLEtBQTNCLENBQWlDLE1BQWpDLEVBQXlDLENBQXpDLEVBQTRDQSxLQUE1QyxDQUFrRCxHQUFsRCxDQUhzQjtBQUFBO0FBQUEsVUFFakJLLFFBRmlCO0FBQUEsVUFFUEMsRUFGTztBQUFBLFVBRUFDLFdBRkE7O0FBSXhCLFVBQU1DLE9BQU9ELFlBQVlILE1BQVosS0FBdUIsQ0FBdkIsR0FDVCxFQURTLFNBRUxHLFlBQVlFLElBQVosQ0FBaUIsR0FBakIsQ0FGUjs7QUFJQSxhQUFPLElBQUlYLEtBQUosQ0FBVUcsTUFBVixFQUFrQkksUUFBbEIsRUFBNEJDLEVBQTVCLEVBQWdDRSxJQUFoQyxDQUFQO0FBQ0Q7OztBQUtELGlCQUFZUCxNQUFaLEVBQTJCSSxRQUEzQixFQUE0Q0MsRUFBNUMsRUFBdURFLElBQXZELEVBQW9FO0FBQUE7O0FBQ2xFLFNBQUtQLE1BQUwsR0FBY0EsTUFBZDtBQUNBLFNBQUtJLFFBQUwsR0FBZ0JBLFFBQWhCO0FBQ0EsU0FBS0MsRUFBTCxHQUFVQSxFQUFWO0FBQ0EsU0FBS0UsSUFBTCxHQUFZQSxJQUFaO0FBQ0Q7Ozs7O0lBR1VFLGlCLFdBQUFBLGlCOzs7O1NBQ1hDLFcsR0FBcUIsQ0FBQyxDO1NBQ3RCQyxhLEdBQ0ksVUFBR0Msa0JBQUgsQ0FBc0JDLHlCQUF0QixHQUNBLFVBQUdELGtCQUFILENBQXNCRSxtQjtTQUMxQmQsTSxHQUFnQixJOzs7Ozs4QkFDTmUsSSxFQUFhZixNLEVBQWU7QUFDcEMsYUFBTyxLQUFQO0FBQ0Q7OzsyQkFDTUYsSSxFQUFha0IsTyxFQUFnQkMsTyxFQUE0QjtBQUM5REMseUNBQWlDQyxLQUFLQyxTQUFMLENBQWV0QixJQUFmLENBQWpDLFVBQTBEcUIsS0FBS0MsU0FBTCxDQUFlSixPQUFmLENBQTFELFdBQXNGQyxXQUFTLElBQVQsR0FBZ0IsTUFBaEIsR0FBeUJBLFFBQVFuQixJQUF2SDtBQUNBLFVBQUltQixZQUFZLElBQVosSUFBb0JuQixLQUFLdUIsVUFBTCxDQUFtQixLQUFLckIsTUFBeEIsT0FBeEIsRUFBNEQ7QUFBQSwyQkFDN0JILE1BQU15QixLQUFOLENBQVl4QixJQUFaLENBRDZCO0FBQUEsWUFDbkRNLFFBRG1ELGdCQUNuREEsUUFEbUQ7QUFBQSxZQUN6Q0MsRUFEeUMsZ0JBQ3pDQSxFQUR5QztBQUFBLFlBQ3JDRSxJQURxQyxnQkFDckNBLElBRHFDOztBQUUxRCxZQUFNZ0IsTUFBTSxJQUFJQyxPQUFKLENBQVlwQixRQUFaLEVBQXNCQyxFQUF0QixFQUEwQkUsSUFBMUIsQ0FBWjtBQUNBLGVBQU81QixVQUFVOEMsTUFBVixDQUFpQkQsUUFBUUUsZUFBUixDQUF3QkgsR0FBeEIsRUFBNkJJLFFBQTdCLEVBQWpCLEVBQ2lCWCxPQURqQixFQUVpQkMsT0FGakIsQ0FBUDtBQUdELE9BTkQsTUFNTztBQUNMLGNBQU1XLDJEQUF5RDlCLElBQXpELHFCQUE2RW1CLFFBQVFuQixJQUFyRixDQUFOO0FBQ0Q7QUFDRjs7OytCQUNVK0IsRyxFQUF1QjtBQUNoQyxhQUFPLEtBQUtDLFdBQUwsQ0FBaUJELEdBQWpCLEVBQXNCLElBQXRCLENBQVA7QUFDRDs7O2dDQUNXQSxHLEVBQVlFLFEsRUFBc0M7QUFDNURiLDhDQUFzQ0MsS0FBS0MsU0FBTCxDQUFlUyxJQUFJL0IsSUFBbkIsQ0FBdEMsVUFBbUVrQyxPQUFPRCxRQUFQLENBQW5FO0FBQ0EsWUFBTSxJQUFJSCxLQUFKLDJDQUFrREMsSUFBSS9CLElBQXRELENBQU47QUFDRDs7O21DQUNjbUMsRyxFQUFpQztBQUM5QyxVQUFJQSxJQUFJQyxNQUFKLENBQVcsVUFBR3RCLGtCQUFkLEtBQ0FxQixJQUFJQyxNQUFKLENBQVcsVUFBR0MsV0FBZCxDQURKLEVBQ2dDO0FBQzlCLGVBQU8sSUFBUDtBQUNEO0FBQ0RqQixxREFBNkNlLElBQUlHLElBQWpELFNBQXlESCxJQUFJSSxNQUE3RDtBQUNBLFlBQU0sVUFBR0MscUJBQVQ7QUFDRDs7Ozs7O0lBR1VkLE8sV0FBQUEsTzs7OzBCQUNFMUIsSSxFQUFxQjtBQUFBLHlCQUNUQSxLQUFLQyxLQUFMLENBQVcsR0FBWCxDQURTO0FBQUE7QUFBQSxVQUN6QkMsTUFEeUI7QUFBQSxVQUNkQyxDQURjOztBQUFBLG1DQUc5QkgsS0FBS0ksTUFBTCxDQUFZRixPQUFPRyxNQUFuQixFQUEyQkosS0FBM0IsQ0FBaUMsTUFBakMsRUFBeUMsQ0FBekMsRUFBNENBLEtBQTVDLENBQWtELEdBQWxELENBSDhCO0FBQUE7QUFBQSxVQUV6Qk0sRUFGeUI7QUFBQSxVQUVsQkMsV0FGa0I7O0FBSWhDLFVBQU1DLE9BQU9ELFlBQVlILE1BQVosS0FBdUIsQ0FBdkIsR0FDVCxFQURTLFNBRUxHLFlBQVlFLElBQVosQ0FBaUIsR0FBakIsQ0FGUjs7QUFJQSxhQUFPLElBQUlnQixPQUFKLENBQVl4QixNQUFaLEVBQW9CSyxFQUFwQixFQUF3QkUsSUFBeEIsQ0FBUDtBQUNEOzs7b0NBQ3NCc0IsRyxFQUFxQjtBQUMxQyxhQUFPLElBQUlMLE9BQUosQ0FBWUssSUFBSTdCLE1BQWhCLEVBQ2EsbUJBQVM2QixJQUFJeEIsRUFBYixFQUFpQmtDLElBQWpCLEdBQXdCQyxtQkFBeEIsQ0FBNEMsUUFBNUMsQ0FEYixFQUVhWCxJQUFJdEIsSUFGakIsQ0FBUDtBQUdEOzs7b0NBQ3NCc0IsRyxFQUFxQjtBQUMxQyxhQUFPLElBQUlMLE9BQUosQ0FBWUssSUFBSTdCLE1BQWhCLEVBQ2EsbUJBQVM2QixJQUFJeEIsRUFBYixFQUFpQm9DLElBQWpCLEdBQXdCRCxtQkFBeEIsQ0FBNEMsV0FBNUMsQ0FEYixFQUVhWCxJQUFJdEIsSUFGakIsQ0FBUDtBQUdEOzs7QUFJRCxtQkFBWVAsTUFBWixFQUEyQkssRUFBM0IsRUFBc0NFLElBQXRDLEVBQW1EO0FBQUE7O0FBQ2pELFNBQUtQLE1BQUwsR0FBY0EsTUFBZDtBQUNBLFNBQUtLLEVBQUwsR0FBVUEsRUFBVjtBQUNBLFNBQUtFLElBQUwsR0FBWUEsSUFBWjtBQUNEOzs7O3NDQUN5QjtBQUN4QixhQUFPaUIsUUFBUUUsZUFBUixDQUF3QixJQUF4QixDQUFQO0FBQ0Q7OztzQ0FDeUI7QUFDeEIsYUFBT0YsUUFBUWtCLGVBQVIsQ0FBd0IsSUFBeEIsQ0FBUDtBQUNEOzs7K0JBQ2lCO0FBQ2hCLGFBQVUsS0FBSzFDLE1BQWYsV0FBMkIsS0FBS0ssRUFBaEMsR0FBcUMsS0FBS0UsSUFBMUM7QUFDRDs7Ozs7O0lBR1VvQyxtQixXQUFBQSxtQjtBQUtYLCtCQUFZM0MsTUFBWixFQUEyQjtBQUFBOztBQUFBLFNBSjNCVSxXQUkyQixHQUpOLENBQUMsQ0FJSztBQUFBLFNBSDNCQyxhQUcyQixHQUZ2QixVQUFHQyxrQkFBSCxDQUFzQkMseUJBRUM7O0FBQ3pCLFNBQUtiLE1BQUwsR0FBY0EsTUFBZDtBQUNEOzs7OzhCQUNTZSxJLEVBQWFmLE0sRUFBZTtBQUNwQyxhQUFPLEtBQVA7QUFDRDs7OzJCQUNNRixJLEVBQWFrQixPLEVBQWdCQyxPLEVBQTRCO0FBQzlEQyxvQ0FBNEIsS0FBS2xCLE1BQWpDLGlCQUFtRG1CLEtBQUtDLFNBQUwsQ0FBZXRCLElBQWYsQ0FBbkQsVUFBNEVxQixLQUFLQyxTQUFMLENBQWVKLE9BQWYsQ0FBNUUsV0FBd0dDLFdBQVMsSUFBVCxHQUFnQixNQUFoQixHQUF5QkEsUUFBUW5CLElBQXpJOztBQUVBLFVBQUltQixZQUFZLElBQVosSUFBb0JuQixLQUFLdUIsVUFBTCxDQUFtQixLQUFLckIsTUFBeEIsT0FBeEIsRUFBNEQ7QUFDMUQsWUFBTXVCLE1BQU1DLFFBQVFGLEtBQVIsQ0FBY3hCLElBQWQsQ0FBWjtBQUNBLFlBQUl5QixJQUFJdkIsTUFBSixLQUFlLEtBQUtBLE1BQXhCLEVBQWdDO0FBQzlCbEIsc0JBQVk4RCxJQUFaLENBQWlCLFVBQUc1RCxjQUFILENBQWtCNkQsZ0JBQW5DLEVBQ2tCLEtBQUtuQyxXQUR2QixFQUVrQmMsUUFBUUUsZUFBUixDQUF3QkgsR0FBeEIsRUFBNkJJLFFBQTdCLEVBRmxCLEVBR2tCWCxPQUhsQixFQUlrQixJQUpsQjtBQUtELFNBTkQsTUFNTztBQUNMLGdCQUFNWSxtQ0FBaUM5QixJQUFqQyxhQUE2QyxLQUFLRSxNQUFsRCx1QkFBTjtBQUNEO0FBQ0YsT0FYRCxNQVdPO0FBQ0xsQixvQkFBWThELElBQVosQ0FBaUIsVUFBRzVELGNBQUgsQ0FBa0I2RCxnQkFBbkMsRUFDa0IsS0FBS25DLFdBRHZCLEVBRWtCWixJQUZsQixFQUdrQmtCLE9BSGxCLEVBSWtCQyxPQUpsQjtBQUtEO0FBQ0QsYUFBT25DLFlBQVlnRSxLQUFaLEVBQVA7QUFDRDs7OytCQUNVakIsRyxFQUF1QjtBQUNoQyxhQUFPLEtBQUtDLFdBQUwsQ0FBaUJELEdBQWpCLEVBQXNCLElBQXRCLENBQVA7QUFDRDs7O2dDQUNXQSxHLEVBQVlFLFEsRUFBc0M7QUFDNURiLG9DQUE0QixLQUFLbEIsTUFBakMsc0JBQXdEbUIsS0FBS0MsU0FBTCxDQUFlUyxJQUFJL0IsSUFBbkIsQ0FBeEQsVUFBcUZrQyxPQUFPRCxRQUFQLENBQXJGOztBQUQ0RCxrQ0FFakNQLFFBQVFrQixlQUFSLENBQXdCbEIsUUFBUUYsS0FBUixDQUFjTyxJQUFJL0IsSUFBbEIsQ0FBeEIsQ0FGaUM7QUFBQSxVQUVyREUsTUFGcUQseUJBRXJEQSxNQUZxRDtBQUFBLFVBRTdDSyxFQUY2Qyx5QkFFN0NBLEVBRjZDO0FBQUEsVUFFekNFLElBRnlDLHlCQUV6Q0EsSUFGeUM7O0FBRzVELFVBQU1ULGtDQUFnQ0UsTUFBaEMsU0FBMENLLEVBQTFDLEdBQStDRSxJQUFyRDtBQUNBLFVBQU1nQixNQUFNNUMsVUFBVThDLE1BQVYsQ0FBaUIzQixJQUFqQixFQUF1QitCLElBQUlrQixhQUEzQixFQUEwQyxJQUExQyxDQUFaO0FBQ0EsVUFBTUMsVUFBVXJFLFVBQVVzRSw2QkFBVixDQUF3QzFCLEdBQXhDLEVBQTZDUSxRQUE3QyxDQUFoQjtBQUNBaUIsY0FBUUUsV0FBUixHQUFzQnJCLEdBQXRCO0FBQ0EsYUFBT21CLE9BQVA7QUFDRDs7O21DQUNjZixHLEVBQWlDO0FBQzlDLFVBQUlBLElBQUlDLE1BQUosQ0FBVyxVQUFHdEIsa0JBQWQsS0FDQXFCLElBQUlDLE1BQUosQ0FBVyxVQUFHQyxXQUFkLENBREosRUFDZ0M7QUFDOUIsZUFBTyxJQUFQO0FBQ0Q7QUFDRGpCLHFEQUE2Q2UsSUFBSUcsSUFBakQsU0FBeURILElBQUlJLE1BQTdEO0FBQ0EsWUFBTSxVQUFHQyxxQkFBVDtBQUNEOzs7Ozs7SUFHVWEsTyxXQUFBQSxPO0FBRVgsbUJBQVlDLFFBQVosRUFBaUM7QUFBQTs7QUFDL0IsU0FBS0EsUUFBTCxHQUFnQkEsUUFBaEI7QUFDRDs7OzttQ0FDY0MsSyxFQUEyQnBCLEcsRUFBeUI7QUFDakUsVUFBSW9CLFNBQVMsSUFBYixFQUFtQjtBQUNqQixjQUFNLFVBQUdDLHVCQUFUO0FBQ0Q7O0FBRUQsYUFBTyxLQUFLRixRQUFaO0FBQ0Q7OztnQ0FDV0csSSxFQUFtQjtBQUM3QixZQUFNLFVBQUdDLHdCQUFUO0FBQ0Q7OzttQ0FDY3ZCLEcsRUFBa0M7QUFDL0MsVUFBSUEsSUFBSUMsTUFBSixDQUFXLFVBQUdDLFdBQWQsS0FBOEJGLElBQUlDLE1BQUosQ0FBVyxVQUFHdUIsVUFBZCxDQUFsQyxFQUE2RDtBQUMzRCxlQUFPLElBQVA7QUFDRDtBQUNEdkMsMkNBQW1DZSxJQUFJRyxJQUF2QyxTQUErQ0gsSUFBSUksTUFBbkQ7QUFDQSxZQUFNLFVBQUdDLHFCQUFUO0FBQ0Q7Ozs7OztBQUdJLElBQU1vQixzQkFBTyxTQUFQQSxJQUFPLEdBQU07QUFDeEIvRCxxQkFBbUJnRSxlQUFuQixDQUFtQyxnQkFBSSx3Q0FBSixDQUFuQyxFQUNrQyxxQkFEbEMsRUFFa0MseUNBRmxDLEVBR2tDLElBQUlSLE9BQUosQ0FBWSxJQUFJMUMsaUJBQUosRUFBWixDQUhsQzs7QUFLQWQscUJBQW1CZ0UsZUFBbkIsQ0FBbUMsZ0JBQUksd0NBQUosQ0FBbkMsRUFDa0MsdUJBRGxDLEVBRWtDLDJDQUZsQyxFQUdrQyxJQUFJUixPQUFKLENBQVksSUFBSVIsbUJBQUosQ0FBd0IsTUFBeEIsQ0FBWixDQUhsQzs7QUFLQWhELHFCQUFtQmdFLGVBQW5CLENBQW1DLGdCQUFJLHdDQUFKLENBQW5DLEVBQ2tDLHVCQURsQyxFQUVrQywyQ0FGbEMsRUFHa0MsSUFBSVIsT0FBSixDQUFZLElBQUlSLG1CQUFKLENBQXdCLE1BQXhCLENBQVosQ0FIbEM7O0FBS0FoRCxxQkFBbUJnRSxlQUFuQixDQUFtQyxnQkFBSSx3Q0FBSixDQUFuQyxFQUNrQyx1QkFEbEMsRUFFa0MsMkNBRmxDLEVBR2tDLElBQUlSLE9BQUosQ0FBWSxJQUFJUixtQkFBSixDQUF3QixNQUF4QixDQUFaLENBSGxDOztBQUtBLE1BQUl4RCxRQUFReUUsV0FBUixJQUF1QixVQUFHeEUsYUFBSCxDQUFpQnlFLG9CQUE1QyxFQUFrRTtBQUNoRXRFLGdDQUNFdUUsaUJBREYsc0NBQ3NEQyxPQUR0RCxxQkFDOEUsSUFEOUU7QUFFRDtBQUNGLENBekJNIiwiZmlsZSI6ImluZGV4LmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyogQGZsb3cgKi9cblxuaW1wb3J0IHR5cGUge1xuICBuc0lVUkksXG4gIG5zSUlEUmVmLFxuICBuc0lDaGFubmVsLFxuICBuc0lGYWN0b3J5LFxuICBuc0lTdXBwb3J0cyxcbiAgbnNJTG9hZEluZm8sXG4gIG5zSVByb3RvY29sSGFuZGxlclxufSBmcm9tIFwiLi9nZWNrb1wiXG5pbXBvcnQge0NjLCBDaSwgQ3IsIENtLCBDSUR9IGZyb20gXCIuL2dlY2tvXCJcbmltcG9ydCBDSURTIGZyb20gXCJjaWRzXCJcblxuY29uc3QgaW9TZXJ2aWNlID1cbiAgQ2NbJ0Btb3ppbGxhLm9yZy9uZXR3b3JrL2lvLXNlcnZpY2U7MSddLlxuICBnZXRTZXJ2aWNlKENpLm5zSUlPU2VydmljZSlcblxuY29uc3Qgc3RhbmRhcmRVUkwgPVxuICBDY1tcIkBtb3ppbGxhLm9yZy9uZXR3b3JrL3N0YW5kYXJkLXVybDsxXCJdLlxuICBjcmVhdGVJbnN0YW5jZShDaS5uc0lTdGFuZGFyZFVSTClcblxuc3RhbmRhcmRVUkwuUXVlcnlJbnRlcmZhY2UoQ2kubnNJVVJMKVxuXG5jb25zdCBydW50aW1lID1cbiAgQ2NbXCJAbW96aWxsYS5vcmcveHJlL2FwcC1pbmZvOzFcIl0uXG4gIGdldFNlcnZpY2UoQ2kubnNJWFVMUnVudGltZSlcblxuY29uc3QgY2hpbGRQcm9jZXNzTWVzc2FnZU1hbmFnZXIgPVxuICBDY1tcIkBtb3ppbGxhLm9yZy9jaGlsZHByb2Nlc3NtZXNzYWdlbWFuYWdlcjsxXCJdLlxuICBnZXRTZXJ2aWNlKENpLm5zSVN5bmNNZXNzYWdlU2VuZGVyKVxuXG5jb25zdCBwYXJlbnRQcm9jZXNzTWVzc2FnZU1hbmFnZXIgPVxuICBDY1tcIkBtb3ppbGxhLm9yZy9wYXJlbnRwcm9jZXNzbWVzc2FnZW1hbmFnZXI7MVwiXS5cbiAgZ2V0U2VydmljZShDaS5uc0lNZXNzYWdlQnJvYWRjYXN0ZXIpXG5cbmNvbnN0IHNlY3VyaXR5TWFuYWdlciA9XG4gIENjW1wiQG1vemlsbGEub3JnL3NjcmlwdHNlY3VyaXR5bWFuYWdlcjsxXCJdLlxuICBnZXRTZXJ2aWNlKENpLm5zSVNjcmlwdFNlY3VyaXR5TWFuYWdlcilcblxuY29uc3QgY29tcG9uZW50UmVnaXN0cmFyID0gQ20uUXVlcnlJbnRlcmZhY2UoQ2kubnNJQ29tcG9uZW50UmVnaXN0cmFyKVxuXG5kZWNsYXJlIHZhciBfX1VSSV9fOnN0cmluZ1xuZGVjbGFyZSBmdW5jdGlvbiBkdW1wICh0ZXh0OnN0cmluZyk6dm9pZFxuXG4vLyBleHBvcnQgY2xhc3MgRlNVUkkge1xuLy8gICBvcmlnaW5DaGFyc2V0OnN0cmluZ1xuLy8gICBzcGVjOnN0cmluZ1xuLy8gICBhc2NpaVNwZWM6c3RyaW5nXG4vLyAgIGhvc3Q6c3RyaW5nXG4vLyAgIGFzY2lpSG9zdDpzdHJpbmdcbi8vICAgaG9zdFBvcnQ6c3RyaW5nXG4vLyAgIGFzY2lpSG9zdFBvcnQ6c3RyaW5nXG4vLyAgIHF1ZXJ5OnN0cmluZ1xuLy8gICByZWY6c3RyaW5nXG4vLyAgIGhhc1JlZjpib29sZWFuXG4vLyAgIHBhdGg6c3RyaW5nXG4vLyAgIHByZVBhdGg6c3RyaW5nXG4vLyAgIHNwZWNJZ25vcmluZ1JlZjpzdHJpbmdcbi8vICAgZmlsZVBhdGg6c3RyaW5nXG4vLyAgIHNjaGVtZTpzdHJpbmcgPSAnZnMnXG4vLyAgIHBhc3N3b3JkOnN0cmluZyA9ICcnXG4vLyAgIHVzZXJuYW1lOnN0cmluZyA9ICcnXG4vLyAgIHVzZXJQYXNzOnN0cmluZyA9ICcnXG4vLyAgIHBvcnQ6bnVtYmVyID0gLTFcbi8vICAgbXV0YWJsZTpib29sZWFuID0gZmFsc2Vcbi8vICAgY29udHJhY3RJRDpzdHJpbmd8bnVsbCA9ICdAbW96aWxsYS5vcmcvbmV0d29yay9pcGZzLXVyaTsxJ1xuLy8gICBjbGFzc0lEOm5zSUlEUmVmID0gQ0lEKCd7MTE0OGYzMGMtMGVjNy00YTQzLTg4MDItY2ZhZmMwYzlkZDlhfScpXG4vLyAgIGNsYXNzRGVzY3JpcHRpb246c3RyaW5nID0gJ2lwZnMgcHJvdG9jb2wgdXJpJ1xuLy8gICBzdGF0aWMgY3JlYXRlKGlkOnN0cmluZyxcbi8vICAgICAgICAgICAgICAgICBwcm90b2NvbDpzdHJpbmcsXG4vLyAgICAgICAgICAgICAgICAgZmlsZVBhdGg6c3RyaW5nLFxuLy8gICAgICAgICAgICAgICAgIHF1ZXJ5OnN0cmluZyxcbi8vICAgICAgICAgICAgICAgICByZWY6c3RyaW5nLFxuLy8gICAgICAgICAgICAgICAgIG9yaWdpbkNoYXJzZXQ6c3RyaW5nKTpGU1VSSSB7XG4vLyAgICAgY29uc3QgaG9zdCA9IGAke3Byb3RvY29sfS8ke2lkfWBcbi8vICAgICBjb25zdCBzZWFyY2ggPSBxdWVyeSA9PT0gJydcbi8vICAgICAgID8gcXVlcnlcbi8vICAgICAgIDogYD8ke3F1ZXJ5fWBcbi8vICAgICBjb25zdCBoYXNoID0gcmVmID09PSAnJ1xuLy8gICAgICAgPyByZWZcbi8vICAgICAgIDogYCMke3JlZn1gXG4vLyAgICAgY29uc3QgcHJlUGF0aCA9IGBmczovLyR7aG9zdH1gXG4vLyAgICAgY29uc3QgcGF0aCA9IGAke2ZpbGVQYXRofSR7c2VhcmNofSR7aGFzaH1gXG4vLyAgICAgY29uc3Qgc3BlYyA9IGAke3ByZVBhdGh9JHtwYXRofWBcbi8vICAgICBjb25zdCBzcGVjSWdub3JpbmdSZWYgPSBzZWFyY2ggPT09ICcnXG4vLyAgICAgICA/IHNwZWNcbi8vICAgICAgIDogc3BlYy5zdWJzdHIoMCwgc3BlYy5sZW5ndGggLSBzZWFyY2gubGVuZ3RoKVxuLy9cbi8vICAgICByZXR1cm4gbmV3IEZTVVJJKHNwZWMsIG9yaWdpbkNoYXJzZXQsIGhvc3QsIHByZVBhdGgsIHBhdGgsIGZpbGVQYXRoLCBxdWVyeSwgcmVmLCBzcGVjSWdub3JpbmdSZWYpXG4vLyAgIH1cbi8vICAgY29uc3RydWN0b3Ioc3BlYzpzdHJpbmcsXG4vLyAgICAgICAgICAgICAgIG9yaWdpbkNoYXJzZXQ6c3RyaW5nLFxuLy8gICAgICAgICAgICAgICBob3N0OnN0cmluZyxcbi8vICAgICAgICAgICAgICAgcHJlUGF0aDpzdHJpbmcsXG4vLyAgICAgICAgICAgICAgIHBhdGg6c3RyaW5nLFxuLy8gICAgICAgICAgICAgICBmaWxlUGF0aDpzdHJpbmcsXG4vLyAgICAgICAgICAgICAgIHF1ZXJ5OnN0cmluZyxcbi8vICAgICAgICAgICAgICAgcmVmOnN0cmluZyxcbi8vICAgICAgICAgICAgICAgc3BlY0lnbm9yaW5nUmVmOnN0cmluZykge1xuLy8gICAgIHRoaXMub3JpZ2luQ2hhcnNldCAgPSBvcmlnaW5DaGFyc2V0XG4vLyAgICAgdGhpcy5hc2NpaVNwZWMgPSB0aGlzLnNwZWNcbi8vICAgICB0aGlzLmhvc3QgPSBob3N0XG4vLyAgICAgdGhpcy5hc2NpaUhvc3QgPSB0aGlzLmhvc3Rcbi8vICAgICB0aGlzLmhvc3RQb3J0ID0gdGhpcy5ob3N0XG4vLyAgICAgdGhpcy5hc2NpaUhvc3RQb3J0ID0gdGhpcy5ob3N0XG4vLyAgICAgdGhpcy5yZWYgPSByZWZcbi8vICAgICB0aGlzLmhhc1JlZiA9IHRoaXMucmVmID09PSAnJ1xuLy8gICAgIHRoaXMucHJlUGF0aCA9ICBwcmVQYXRoXG4vLyAgICAgdGhpcy5wYXRoID0gcGF0aFxuLy8gICAgIHRoaXMuc3BlYyA9IHNwZWNcbi8vICAgICB0aGlzLnNwZWNJZ25vcmluZ1JlZiA9IHNwZWNJZ25vcmluZ1JlZlxuLy8gICAgIHRoaXMuZmlsZVBhdGggPSBmaWxlUGF0aFxuLy8gICB9XG4vLyAgIFF1ZXJ5SW50ZXJmYWNlKGlpZDpuc0lJRFJlZik6bnNJVVJJIHtcbi8vICAgICBpZiAoaWlkLmVxdWFscyhDaS5uc0lVUkkpIHx8XG4vLyAgICAgICAgIGlpZC5lcXVhbHMoQ2kubnNJU3VwcG9ydHMpIHx8XG4vLyAgICAgICAgIGlpZC5lcXVhbHMoQ2kubnNJVVJMKSB8fFxuLy8gICAgICAgICBpaWQuZXF1YWxzKENpLm5zSU11dGFibGUpKSB7XG4vLyAgICAgICByZXR1cm4gdGhpc1xuLy8gICAgIH0gZWxzZSB7XG4vLyAgICAgICBkdW1wKGAhISEgRlNVUkkuUXVlcnlJbnRlcmZhY2UgJHtpaWQubmFtZX0gJHtpaWQubnVtYmVyfVxcbmApXG4vLyAgICAgICB0aHJvdyBDci5OU19FUlJPUl9OT19JTlRFUkZBQ0Vcbi8vICAgICB9XG4vLyAgIH1cbi8vICAgY2xvbmUoKTpzZWxmIHtcbi8vICAgICByZXR1cm4gdGhpcy5jbG9uZVdpdGhOZXdSZWYodGhpcy5yZWYpXG4vLyAgIH1cbi8vICAgY2xvbmVJZ25vcmluZ1JlZigpOnNlbGYge1xuLy8gICAgIHJldHVybiB0aGlzLmNsb25lV2l0aE5ld1JlZignJylcbi8vICAgfVxuLy8gICBjbG9uZVdpdGhOZXdSZWYobmV3UmVmOnN0cmluZyk6c2VsZiB7XG4vLyAgICAgZHVtcChgRlNVUkkuY2xvbmVXaXRoTmV3UmVmICR7bmV3UmVmfVxcbmApXG4vLyAgICAgY29uc3QgcGF0aCA9IHRoaXMucmVmID09PSBuZXdSZWZcbi8vICAgICAgID8gdGhpcy5wYXRoXG4vLyAgICAgICA6IHRoaXMucmVmID09PSAnJ1xuLy8gICAgICAgPyBgJHt0aGlzLnBhdGh9IyR7bmV3UmVmfWBcbi8vICAgICAgIDogYCR7dGhpcy5wYXRoLnN1YnN0cih0aGlzLnBhdGgubGVuZ3RoIC0gdGhpcy5yZWYubGVuZ3RoIC0gMSl9IyR7bmV3UmVmfWBcbi8vICAgICBjb25zdCBzcGVjID0gYCR7dGhpcy5wcmVQYXRofSR7cGF0aH1gXG4vL1xuLy8gICAgIHJldHVybiBuZXcgRlNVUkkoc3BlYyxcbi8vICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9yaWdpbkNoYXJzZXQsXG4vLyAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5ob3N0LFxuLy8gICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJlUGF0aCxcbi8vICAgICAgICAgICAgICAgICAgICAgICBwYXRoLFxuLy8gICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsZVBhdGgsXG4vLyAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5xdWVyeSxcbi8vICAgICAgICAgICAgICAgICAgICAgICBuZXdSZWYsXG4vLyAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zcGVjSWdub3JpbmdSZWYpXG4vLyAgIH1cbi8vICAgZXF1YWxzKG90aGVyOm5zSVVSSSk6Ym9vbGVhbiB7XG4vLyAgICAgZHVtcChgRlNVUkkuZXF1YWxzICR7b3RoZXIuc3BlY31cXG5gKVxuLy8gICAgIHJldHVybiBvdGhlci5zcGVjID09PSB0aGlzLnNwZWNcbi8vICAgfVxuLy8gICBlcXVhbHNFeGNlcHRSZWYob3RoZXI6bnNJVVJJKTpib29sZWFuIHtcbi8vICAgICBkdW1wKGBGU1VSSS5lcXVhbHNFeGNlcHRSZWYgJHtvdGhlci5zcGVjSWdub3JpbmdSZWZ9XFxuYClcbi8vICAgICByZXR1cm4gb3RoZXIuc3BlY0lnbm9yaW5nUmVmID09PSB0aGlzLnNwZWNJZ25vcmluZ1JlZlxuLy8gICB9XG4vLyAgIHJlc29sdmUocmVsYXRpdmVQYXRoOnN0cmluZyk6c3RyaW5nIHtcbi8vICAgICBkdW1wKGBGU1VSSS5yZXNvbHZlICR7cmVsYXRpdmVQYXRofVxcbmApXG4vLyAgICAgc3RhbmRhcmRVUkwuaW5pdChDaS5uc0lTdGFuZGFyZFVSTC5VUkxUWVBFX1NUQU5EQVJELFxuLy8gICAgICAgICAgICAgICAgICAgICAgIHRoaXMucG9ydCxcbi8vICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNwZWMsXG4vLyAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vcmlnaW5DaGFyc2V0LFxuLy8gICAgICAgICAgICAgICAgICAgICAgIG51bGwpXG4vLyAgICAgcmV0dXJuIHN0YW5kYXJkVVJMLnJlc29sdmUocmVsYXRpdmVQYXRoKVxuLy8gICB9XG4vLyAgIHNjaGVtZUlzKHNjaGVtZTpzdHJpbmcpOmJvb2xlYW4ge1xuLy8gICAgIHJldHVybiB0aGlzLnNjaGVtZSA9PT0gc2NoZW1lXG4vLyAgIH1cbi8vICAgc2V0SG9zdEFuZFBvcnQoaG9zdHBvcnQ6c3RyaW5nKTp2b2lkIHtcbi8vICAgICBkdW1wKGAhISEgRlNVUkkuc2V0SG9zdEFuZFBvcnQgJHtob3N0cG9ydH1cXG5gKVxuLy8gICAgIHRocm93IEVycm9yKCdmcyBwcm90b2NvbCBkb2VzIG5vIHN1cHBvcnQgaG9zdCBhbmQgcG9ydCB1cGRhdGVzJylcbi8vICAgfVxuLy8gfVxuXG5leHBvcnQgY2xhc3MgRlNVUkwge1xuICBzdGF0aWMgcGFyc2Uoc3BlYzpzdHJpbmcpIHtcbiAgICBjb25zdCBbc2NoZW1lLCAuLi5fXSA9IHNwZWMuc3BsaXQoJzonKVxuICAgIGNvbnN0IFtwcm90b2NvbCwgaWQsIC4uLnBhdGhFbnRyaWVzXSA9XG4gICAgICBzcGVjLnN1YnN0cihzY2hlbWUubGVuZ3RoKS5zcGxpdCgvOlxcLyovKVsxXS5zcGxpdCgnLycpXG4gICAgY29uc3QgcGF0aCA9IHBhdGhFbnRyaWVzLmxlbmd0aCA9PT0gMFxuICAgICAgPyAnJ1xuICAgICAgOiBgLyR7cGF0aEVudHJpZXMuam9pbignLycpfWBcblxuICAgIHJldHVybiBuZXcgRlNVUkwoc2NoZW1lLCBwcm90b2NvbCwgaWQsIHBhdGgpXG4gIH1cbiAgc2NoZW1lOnN0cmluZ1xuICBwcm90b2NvbDpzdHJpbmdcbiAgaWQ6c3RyaW5nXG4gIHBhdGg6c3RyaW5nXG4gIGNvbnN0cnVjdG9yKHNjaGVtZTpzdHJpbmcsIHByb3RvY29sOnN0cmluZywgaWQ6c3RyaW5nLCBwYXRoOnN0cmluZykge1xuICAgIHRoaXMuc2NoZW1lID0gc2NoZW1lXG4gICAgdGhpcy5wcm90b2NvbCA9IHByb3RvY29sXG4gICAgdGhpcy5pZCA9IGlkXG4gICAgdGhpcy5wYXRoID0gcGF0aFxuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBGU1Byb3RvY29sSGFuZGxlciB7XG4gIGRlZmF1bHRQb3J0Om51bWJlciA9IC0xXG4gIHByb3RvY29sRmxhZ3M6bnVtYmVyXG4gICAgPSBDaS5uc0lQcm90b2NvbEhhbmRsZXIuVVJJX0xPQURBQkxFX0JZX1NVQlNVTUVSU1xuICAgIHwgQ2kubnNJUHJvdG9jb2xIYW5kbGVyLk9SSUdJTl9JU19GVUxMX1NQRUNcbiAgc2NoZW1lOnN0cmluZyA9ICdmcydcbiAgYWxsb3dQb3J0KHBvcnQ6bnVtYmVyLCBzY2hlbWU6c3RyaW5nKSB7XG4gICAgcmV0dXJuIGZhbHNlXG4gIH1cbiAgbmV3VVJJKHNwZWM6c3RyaW5nLCBjaGFyc2V0OnN0cmluZywgYmFzZVVSSTpudWxsfG5zSVVSSSk6bnNJVVJJIHtcbiAgICBkdW1wKGBGU1Byb3RvY29sSGFuZGxlci5uZXdVUkkoJHtKU09OLnN0cmluZ2lmeShzcGVjKX0sICR7SlNPTi5zdHJpbmdpZnkoY2hhcnNldCl9LCAke2Jhc2VVUkk9PW51bGwgPyAnbnVsbCcgOiBiYXNlVVJJLnNwZWN9KVxcbmApXG4gICAgaWYgKGJhc2VVUkkgPT09IG51bGwgfHwgc3BlYy5zdGFydHNXaXRoKGAke3RoaXMuc2NoZW1lfTpgKSkge1xuICAgICAgY29uc3Qge3Byb3RvY29sLCBpZCwgcGF0aH0gPSBGU1VSTC5wYXJzZShzcGVjKVxuICAgICAgY29uc3QgdXJsID0gbmV3IElQJCRVUkwocHJvdG9jb2wsIGlkLCBwYXRoKVxuICAgICAgcmV0dXJuIGlvU2VydmljZS5uZXdVUkkoSVAkJFVSTC50b0Jhc2UxNkVuY29kZWQodXJsKS50b1N0cmluZygpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hhcnNldCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhc2VVUkkpXG4gICAgfSBlbHNlIHtcbiAgICAgIHRocm93IEVycm9yKGBGUyBQcm90b2NvbCBoYW5kbGVyIGRpZCBub3QgZXhwZWN0ZWQgdG8gcmVzb2x2ZSAke3NwZWN9IHJlbGF0aXZlIHRvICR7YmFzZVVSSS5zcGVjfWApXG4gICAgfVxuICB9XG4gIG5ld0NoYW5uZWwodXJpOm5zSVVSSSk6bnNJQ2hhbm5lbCB7XG4gICAgcmV0dXJuIHRoaXMubmV3Q2hhbm5lbDIodXJpLCBudWxsKVxuICB9XG4gIG5ld0NoYW5uZWwyKHVyaTpuc0lVUkksIGxvYWRJbmZvOm51bGx8bnNJTG9hZEluZm8pOm5zSUNoYW5uZWwge1xuICAgIGR1bXAoYEZTUHJvdG9jb2xIYW5kbGVyLm5ld0NoYW5uZWwyKCR7SlNPTi5zdHJpbmdpZnkodXJpLnNwZWMpfSwgJHtTdHJpbmcobG9hZEluZm8pfSlcXG5gKVxuICAgIHRocm93IG5ldyBFcnJvcihgRGlkIG5vdCBleHBlY3QgdG8gY3JlYXRlIGNoYW5uZWwgZm9yICR7dXJpLnNwZWN9YClcbiAgfVxuICBRdWVyeUludGVyZmFjZShpaWQ6bnNJSURSZWYpOm5zSVByb3RvY29sSGFuZGxlciB7XG4gICAgaWYgKGlpZC5lcXVhbHMoQ2kubnNJUHJvdG9jb2xIYW5kbGVyKSB8fFxuICAgICAgICBpaWQuZXF1YWxzKENpLm5zSVN1cHBvcnRzKSkge1xuICAgICAgcmV0dXJuIHRoaXNcbiAgICB9XG4gICAgZHVtcChgISEhIEZTUHJvdG9jb2xIYW5kbGVyLlF1ZXJ5SW50ZXJmYWNlICR7aWlkLm5hbWV9ICR7aWlkLm51bWJlcn1cXG5gKVxuICAgIHRocm93IENyLk5TX0VSUk9SX05PX0lOVEVSRkFDRVxuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBJUCQkVVJMIHtcbiAgc3RhdGljIHBhcnNlKHNwZWM6c3RyaW5nKTpJUCQkVVJMIHtcbiAgICBjb25zdCBbc2NoZW1lLCAuLi5fXSA9IHNwZWMuc3BsaXQoJzonKVxuICAgIGNvbnN0IFtpZCwgLi4ucGF0aEVudHJpZXNdID1cbiAgICAgIHNwZWMuc3Vic3RyKHNjaGVtZS5sZW5ndGgpLnNwbGl0KC86XFwvKi8pWzFdLnNwbGl0KCcvJylcbiAgICBjb25zdCBwYXRoID0gcGF0aEVudHJpZXMubGVuZ3RoID09PSAwXG4gICAgICA/ICcnXG4gICAgICA6IGAvJHtwYXRoRW50cmllcy5qb2luKCcvJyl9YFxuXG4gICAgcmV0dXJuIG5ldyBJUCQkVVJMKHNjaGVtZSwgaWQsIHBhdGgpXG4gIH1cbiAgc3RhdGljIHRvQmFzZTE2RW5jb2RlZCh1cmk6SVAkJFVSTCk6SVAkJFVSTCB7XG4gICAgcmV0dXJuIG5ldyBJUCQkVVJMKHVyaS5zY2hlbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgQ0lEUyh1cmkuaWQpLnRvVjEoKS50b0Jhc2VFbmNvZGVkU3RyaW5nKCdiYXNlMTYnKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVyaS5wYXRoKVxuICB9XG4gIHN0YXRpYyB0b0Jhc2VFbmNvZGVkVjAodXJpOklQJCRVUkwpOklQJCRVUkwge1xuICAgIHJldHVybiBuZXcgSVAkJFVSTCh1cmkuc2NoZW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IENJRFModXJpLmlkKS50b1YwKCkudG9CYXNlRW5jb2RlZFN0cmluZygnYmFzZTU4YnRjJyksXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmkucGF0aClcbiAgfVxuICBzY2hlbWU6c3RyaW5nXG4gIGlkOnN0cmluZ1xuICBwYXRoOnN0cmluZ1xuICBjb25zdHJ1Y3RvcihzY2hlbWU6c3RyaW5nLCBpZDpzdHJpbmcsIHBhdGg6c3RyaW5nKSB7XG4gICAgdGhpcy5zY2hlbWUgPSBzY2hlbWVcbiAgICB0aGlzLmlkID0gaWRcbiAgICB0aGlzLnBhdGggPSBwYXRoXG4gIH1cbiAgdG9CYXNlMTZFbmNvZGVkKCk6SVAkJFVSTCB7XG4gICAgcmV0dXJuIElQJCRVUkwudG9CYXNlMTZFbmNvZGVkKHRoaXMpXG4gIH1cbiAgdG9CYXNlRW5jb2RlZFYwKCk6SVAkJFVSTCB7XG4gICAgcmV0dXJuIElQJCRVUkwudG9CYXNlRW5jb2RlZFYwKHRoaXMpXG4gIH1cbiAgdG9TdHJpbmcoKTpzdHJpbmcge1xuICAgIHJldHVybiBgJHt0aGlzLnNjaGVtZX06Ly8ke3RoaXMuaWR9JHt0aGlzLnBhdGh9YFxuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBJUCQkUHJvdG9jb2xIYW5kbGVyIHtcbiAgZGVmYXVsdFBvcnQ6bnVtYmVyID0gLTFcbiAgcHJvdG9jb2xGbGFnczpudW1iZXJcbiAgICA9IENpLm5zSVByb3RvY29sSGFuZGxlci5VUklfTE9BREFCTEVfQllfU1VCU1VNRVJTXG4gIHNjaGVtZTpzdHJpbmdcbiAgY29uc3RydWN0b3Ioc2NoZW1lOnN0cmluZykge1xuICAgIHRoaXMuc2NoZW1lID0gc2NoZW1lXG4gIH1cbiAgYWxsb3dQb3J0KHBvcnQ6bnVtYmVyLCBzY2hlbWU6c3RyaW5nKSB7XG4gICAgcmV0dXJuIGZhbHNlXG4gIH1cbiAgbmV3VVJJKHNwZWM6c3RyaW5nLCBjaGFyc2V0OnN0cmluZywgYmFzZVVSSTpudWxsfG5zSVVSSSk6bnNJVVJJIHtcbiAgICBkdW1wKGBJUCQkUHJvdG9jb2xIYW5kbGVyPCR7dGhpcy5zY2hlbWV9Pi5uZXdVUkkoJHtKU09OLnN0cmluZ2lmeShzcGVjKX0sICR7SlNPTi5zdHJpbmdpZnkoY2hhcnNldCl9LCAke2Jhc2VVUkk9PW51bGwgPyAnbnVsbCcgOiBiYXNlVVJJLnNwZWN9KVxcbmApXG5cbiAgICBpZiAoYmFzZVVSSSA9PT0gbnVsbCB8fCBzcGVjLnN0YXJ0c1dpdGgoYCR7dGhpcy5zY2hlbWV9OmApKSB7XG4gICAgICBjb25zdCB1cmwgPSBJUCQkVVJMLnBhcnNlKHNwZWMpXG4gICAgICBpZiAodXJsLnNjaGVtZSA9PT0gdGhpcy5zY2hlbWUpIHtcbiAgICAgICAgc3RhbmRhcmRVUkwuaW5pdChDaS5uc0lTdGFuZGFyZFVSTC5VUkxUWVBFX1NUQU5EQVJELFxuICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRlZmF1bHRQb3J0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICBJUCQkVVJMLnRvQmFzZTE2RW5jb2RlZCh1cmwpLnRvU3RyaW5nKCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGNoYXJzZXQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIG51bGwpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aHJvdyBFcnJvcihgSW52YWxpZCBzcGVjIHdhcyBwYXNzZWQgJHtzcGVjfSBmb3IgJHt0aGlzLnNjaGVtZX0gcHJvdG9jb2wgaGFuZGxlcmApXG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHN0YW5kYXJkVVJMLmluaXQoQ2kubnNJU3RhbmRhcmRVUkwuVVJMVFlQRV9TVEFOREFSRCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGVmYXVsdFBvcnQsXG4gICAgICAgICAgICAgICAgICAgICAgICBzcGVjLFxuICAgICAgICAgICAgICAgICAgICAgICAgY2hhcnNldCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGJhc2VVUkkpXG4gICAgfVxuICAgIHJldHVybiBzdGFuZGFyZFVSTC5jbG9uZSgpXG4gIH1cbiAgbmV3Q2hhbm5lbCh1cmk6bnNJVVJJKTpuc0lDaGFubmVsIHtcbiAgICByZXR1cm4gdGhpcy5uZXdDaGFubmVsMih1cmksIG51bGwpXG4gIH1cbiAgbmV3Q2hhbm5lbDIodXJpOm5zSVVSSSwgbG9hZEluZm86bnVsbHxuc0lMb2FkSW5mbyk6bnNJQ2hhbm5lbCB7XG4gICAgZHVtcChgSVAkJFByb3RvY29sSGFuZGxlcjwke3RoaXMuc2NoZW1lfT4ubmV3Q2hhbm5lbDIoJHtKU09OLnN0cmluZ2lmeSh1cmkuc3BlYyl9LCAke1N0cmluZyhsb2FkSW5mbyl9KVxcbmApXG4gICAgY29uc3Qge3NjaGVtZSwgaWQsIHBhdGh9ID0gSVAkJFVSTC50b0Jhc2VFbmNvZGVkVjAoSVAkJFVSTC5wYXJzZSh1cmkuc3BlYykpXG4gICAgY29uc3Qgc3BlYyA9IGBodHRwOi8vbG9jYWxob3N0OjgwODAvJHtzY2hlbWV9LyR7aWR9JHtwYXRofWBcbiAgICBjb25zdCB1cmwgPSBpb1NlcnZpY2UubmV3VVJJKHNwZWMsIHVyaS5vcmlnaW5DaGFyc2V0LCBudWxsKVxuICAgIGNvbnN0IGNoYW5uZWwgPSBpb1NlcnZpY2UubmV3Q2hhbm5lbEZyb21VUklXaXRoTG9hZEluZm8odXJsLCBsb2FkSW5mbylcbiAgICBjaGFubmVsLm9yaWdpbmFsVVJJID0gdXJpXG4gICAgcmV0dXJuIGNoYW5uZWxcbiAgfVxuICBRdWVyeUludGVyZmFjZShpaWQ6bnNJSURSZWYpOm5zSVByb3RvY29sSGFuZGxlciB7XG4gICAgaWYgKGlpZC5lcXVhbHMoQ2kubnNJUHJvdG9jb2xIYW5kbGVyKSB8fFxuICAgICAgICBpaWQuZXF1YWxzKENpLm5zSVN1cHBvcnRzKSkge1xuICAgICAgcmV0dXJuIHRoaXNcbiAgICB9XG4gICAgZHVtcChgISEhIEZTUHJvdG9jb2xIYW5kbGVyLlF1ZXJ5SW50ZXJmYWNlICR7aWlkLm5hbWV9ICR7aWlkLm51bWJlcn1cXG5gKVxuICAgIHRocm93IENyLk5TX0VSUk9SX05PX0lOVEVSRkFDRVxuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBGYWN0b3J5IDxuc1FJUmVzdWx0PiB7XG4gIGluc3RhbmNlOiBuc1FJUmVzdWx0XG4gIGNvbnN0cnVjdG9yKGluc3RhbmNlOm5zUUlSZXN1bHQpIHtcbiAgICB0aGlzLmluc3RhbmNlID0gaW5zdGFuY2VcbiAgfVxuICBjcmVhdGVJbnN0YW5jZShvdXRlcjpudWxsfG5zSVN1cHBvcnRzPCo+LCBpaWQ6bnNJSURSZWYpOm5zUUlSZXN1bHQge1xuICAgIGlmIChvdXRlciAhPSBudWxsKSB7XG4gICAgICB0aHJvdyBDci5OU19FUlJPUl9OT19BR0dSRUdBVElPTlxuICAgIH1cblxuICAgIHJldHVybiB0aGlzLmluc3RhbmNlXG4gIH1cbiAgbG9ja0ZhY3RvcnkobG9jazpib29sZWFuKTp2b2lkIHtcbiAgICB0aHJvdyBDci5OU19FUlJPUl9OT1RfSU1QTEVNRU5URURcbiAgfVxuICBRdWVyeUludGVyZmFjZShpaWQ6bnNJSURSZWYpOkZhY3Rvcnk8bnNRSVJlc3VsdD4ge1xuICAgIGlmIChpaWQuZXF1YWxzKENpLm5zSVN1cHBvcnRzKSB8fCBpaWQuZXF1YWxzKENpLm5zSUZhY3RvcnkpKSB7XG4gICAgICByZXR1cm4gdGhpc1xuICAgIH1cbiAgICBkdW1wKGAhISEgRmFjdG9yeS5RdWVyeUludGVyZmFjZSAke2lpZC5uYW1lfSAke2lpZC5udW1iZXJ9XFxuYClcbiAgICB0aHJvdyBDci5OU19FUlJPUl9OT19JTlRFUkZBQ0VcbiAgfVxufVxuXG5leHBvcnQgY29uc3QgbWFpbiA9ICgpID0+IHtcbiAgY29tcG9uZW50UmVnaXN0cmFyLnJlZ2lzdGVyRmFjdG9yeShDSUQoJ3tiNmM5M2E0Ny03NzhhLWY2NDMtYjBjOC03OWY2YmU2ODVlMDZ9JyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnRlMgcHJvdG9jb2wgaGFuZGxlcicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnQG1vemlsbGEub3JnL25ldHdvcmsvcHJvdG9jb2w7MT9uYW1lPWZzJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBGYWN0b3J5KG5ldyBGU1Byb3RvY29sSGFuZGxlcigpKSlcblxuICBjb21wb25lbnRSZWdpc3RyYXIucmVnaXN0ZXJGYWN0b3J5KENJRCgne2QwNDE1OTY3LTc1YTEtNDUyOC04MDMwLWI3OWQ1NTUyMTI3ZH0nKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdJUEZTIHByb3RvY29sIGhhbmRsZXInLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ0Btb3ppbGxhLm9yZy9uZXR3b3JrL3Byb3RvY29sOzE/bmFtZT1pcGZzJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBGYWN0b3J5KG5ldyBJUCQkUHJvdG9jb2xIYW5kbGVyKCdpcGZzJykpKVxuXG4gIGNvbXBvbmVudFJlZ2lzdHJhci5yZWdpc3RlckZhY3RvcnkoQ0lEKCd7Zjg2NmE0NmMtMmU3OS00NGU2LTkyOWQtMzM0ZmRmOGE3ZmQ3fScpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ0lQTlMgcHJvdG9jb2wgaGFuZGxlcicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnQG1vemlsbGEub3JnL25ldHdvcmsvcHJvdG9jb2w7MT9uYW1lPWlwbnMnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IEZhY3RvcnkobmV3IElQJCRQcm90b2NvbEhhbmRsZXIoJ2lwbnMnKSkpXG5cbiAgY29tcG9uZW50UmVnaXN0cmFyLnJlZ2lzdGVyRmFjdG9yeShDSUQoJ3s4ZWY5MzUxNC0zMDZhLTQ5YTUtYTlmYS1mN2E5YzcwOWIwNjF9JyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnSVBETCBwcm90b2NvbCBoYW5kbGVyJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdAbW96aWxsYS5vcmcvbmV0d29yay9wcm90b2NvbDsxP25hbWU9aXBkbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgRmFjdG9yeShuZXcgSVAkJFByb3RvY29sSGFuZGxlcignaXBkbCcpKSlcblxuICBpZiAocnVudGltZS5wcm9jZXNzVHlwZSA9PSBDaS5uc0lYVUxSdW50aW1lLlBST0NFU1NfVFlQRV9ERUZBVUxUKSB7XG4gICAgcGFyZW50UHJvY2Vzc01lc3NhZ2VNYW5hZ2VyLlxuICAgICAgbG9hZFByb2Nlc3NTY3JpcHQoYGRhdGE6LENvbXBvbmVudHMudXRpbHMuaW1wb3J0KFwiJHtfX1VSSV9ffVwiLCB7fSkubWFpbigpYCwgdHJ1ZSlcbiAgfVxufVxuIl19